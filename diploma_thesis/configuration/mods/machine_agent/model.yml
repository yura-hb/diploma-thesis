kind: 'rl'
parameters:
  model:
    kind: 'deep_multi_rule'
    parameters:
      rules: 'all'
      policy:
        kind: 'discrete_action'
        parameters:
          q_model:
            state:
              - kind: 'partial_instance_norm'
                parameters:
                  channels: 17
              - kind: 'linear'
                parameters:
                  dim: 64
                  activation: 'tanh'
              - kind: 'linear'
                parameters:
                  dim: 48
                  activation: 'tanh'
              - kind: 'linear'
                parameters:
                  dim: 48
                  activation: 'tanh'
              - kind: 'linear'
                parameters:
                  dim: 36
                  activation: 'tanh'
              - kind: 'linear'
                parameters:
                  dim: 24
                  activation: 'tanh'
          action_selector:
            kind: 'phase_selector'
            parameters:
              default:
                kind: 'greedy'
              phases:
                - phase:
                    kind: 'training'
                  action_selector:
                    kind: 'epsilon_greedy'
                    parameters:
                      epsilon: 0.2
                - phase:
                    kind: 'warm_up'
                    parameters:
                      step: 0
                  action_selector:
                    kind: 'uniform'
                - phase:
                    kind: 'warm_up'
                    parameters:
                      step: 1
                  action_selector:
                    kind: 'sample'
                    parameters:
                      is_distribution: false

  encoder:
    kind: 'deep_marl_indirect'

  trainer:
    kind: 'ddqn'
    parameters:
      memory:
        kind: 'prioritized_replay'
        parameters:
          size: 8192
          batch_size: 128

      loss:
        kind: 'smooth_l1'

      optimizer:
        model:
          kind: 'adam'
          parameters:
            lr: 0.001

      return:
        kind: 'no'
        parameters:
          discount_factor: 0.99


